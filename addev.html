<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="css/style.css">
        <link rel="stylesheet" type="text/css" href="css/grid.css">
		<link href="https://unpkg.com/ionicons@4.1.2/dist/css/ionicons.min.css" rel="stylesheet">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
        <title>HADES</title>
    </head>
    <body>
        <div class="row">
            <div style="float: left; margin-left: 5vw" id="back">
            </div>
            <div class="row hd2"><strong>Create Event</strong></div>
        </div>
        <div class="row">
            <form class="tform" id="create">
                <div class="field r6">
                    <input type="text" name="ename" id="ename" required placeholder="Devfest">
                    <label for="ename">Name of Event</label>
                </div>          
                <div class="field r7">
                    <input type="text" id="todate" name="todate" required placeholder="26th June">
                    <label for="todate">End Date</label>
                </div>
                <div class="field r8">
                    <input type="text" id="fdate" name="fdate" required placeholder="31st March">
                    <label for="fdate">Start Date</label>
                </div>
                <div class="field r9">
                    <input type="text" id="totime" name="totime" required placeholder="12 PM">
                    <label for="totime">End Time</label>
                </div>
                <div class="field r8">
                    <input type="text" id="ftime" name="ftime" required placeholder="12 PM">
                    <label for="ftime">Start Time</label>
                </div>
                <div class="field r5">
                    <input type="text" id="budget" name="budget" required placeholder="198900">
                    <label for="budget">Budget</label>
                </div>
                <div class="field r9">
                    <input type="text" name="desc" id="desc" required placeholder="Technical Event">
                    <label for="desc">Description</label>
                </div>
                <div class="field r9">
                    <input type="text" name="cat" id="cat" required placeholder="Technical">
                    <label for="cat">Category</label>
                </div>
                <div class="field r10">
                    <input type="text" name="ven" id="ven" required placeholder="Kamaraj">
                    <label for="ven">Venue</label>
                </div>
                <div class="field r9">
                    <input type="text" name="att" id="att" required placeholder="1500">
                    <label for="att">Attendance</label>
                </div>
                <div class="field r11">
                    <input type="text" name="exp" id="exp" required placeholder="1600">
                    <label for="exp">Expected Participants</label>
                </div>
                <div class="field r12">
                    <input type="text" name="facn" id="facn" required placeholder="Kalyanaraman P">
                    <label for="facn">Faculty Coordinator: Name</label>
                </div>
                <div class="field r13">
                    <input type="text" name="facr" id="facr" required placeholder="10001">
                    <label for="facr">faculty coordinator: ID</label>
                </div>
                <div class="field r12">
                    <input type="text" name="facem" id="facem" required placeholder="kalyanaraman.p@vit.ac.in">
                    <label for="facem">faculty coordinator: email</label>
                </div>           
                <div class="field r14">
                    <input type="text" name="facp" id="facp" required placeholder="9874125630">
                    <label for="facp">faculty coordinator: Phone</label>
                </div>     
                <div class="field r15">
                    <input type="text" name="facg" id="facg" required placeholder="M/F">
                    <label for="facg">faculty coordinator: gender</label>
                </div>
                <div class="field r12">
                    <input type="text" name="stun" id="stun" required placeholder="Angad Sharma">
                    <label for="stun">Student Coordinator: Name</label>
                </div>
                <div class="field r13">
                    <input type="text" name="stur" id="stur" required placeholder="17BCE2009">
                    <label for="stur">Student coordinator: ID</label>
                </div>
                <div class="field r12">
                    <input type="text" name="stuem" id="stuem" required placeholder="angad.sharma@vit.ac.in">
                    <label for="stuem">Student coordinator: email</label>
                </div>           
                <div class="field r14">
                    <input type="text" name="stup" id="stup" required placeholder="9874125630">
                    <label for="stup">Student coordinator: Phone</label>
                </div>     
                <div class="field r15">
                    <input type="text" name="stug" id="stug" required placeholder="M/F">
                    <label for="stug">Student coordinator: gender</label>
                </div>
                <div class="field r16">
                    <input type="text" name="cgn" id="cgn" required placeholder="Iggy Azalea">
                    <label for="cgn">Chief guest: Name</label>
                </div>
                <div class="field r16">
                    <input type="text" name="cgem" id="cgem" required placeholder="amethystamelia.kelly@gmail.com">
                    <label for="cgem">Chief guest: email</label>
                </div>
                <div class="field r17">
                    <input type="text" name="cgp" id="cgp" required placeholder="9874125630">
                    <label for="cgp">Chief guest: Phone</label>
                </div>     
                <div class="field r18">
                    <input type="text" name="cgg" id="cgg" required placeholder="M/F">
                    <label for="cgg">Chief Guest: gender</label>
                </div>   
                <div class="field r19">
                    <input type="text" name="cgs" id="cgs" required placeholder="K.R.E.A.M.">
                    <label for="cgs">Chief Guest: stake</label>
                </div>   
                <div class="field r15">
                    <input type="text" name="cgl" id="cgl" required placeholder="ITC Fortune Park">
                    <label for="cgl">Chief Guest: location of stay</label>
                </div>   
                <div class="field r6">
                    <input type="text" name="pro" id="pro" required placeholder="ABCDEFGHIJKLMNOPQRSTUVWXYZ">
                    <label for="pro">PRO REquest</label>
                </div>
                <div class="field r12">
                    <input type="text" name="cer" id="cer" required placeholder="ABCDEFG, HIJ, KLMNOPQ, RSTUV, WXYZ">
                    <label for="cer">campus engineer request</label>
                </div>
                <div class="field r9">
                    <input type="text" name="dur" id="dur" required placeholder="3 Months">
                    <label for="dur">Duration</label>
                </div>
                <div class="field r20">
                    <input type="text" name="msn" id="msn" required placeholder="Iggy Azalea">
                    <label for="msn">Main Sponsor: Name</label>
                </div>
                <div class="field r20">
                    <input type="text" name="msem" id="msem" required placeholder="amethystamelia.kelly@gmail.com">
                    <label for="msem">Main Sponsor: email</label>
                </div>
                <div class="field r21">
                    <input type="text" name="msp" id="msp" required placeholder="9874125630">
                    <label for="msp">Main Sponsor: Phone</label>
                </div>     
                <div class="field r22">
                    <input type="text" name="msg" id="msg" required placeholder="M/F">
                    <label for="msg">Main Sponsor: gender</label>
                </div>   
                <div class="field r23">
                    <input type="text" name="mss" id="mss" required placeholder="K.R.E.A.M.">
                    <label for="mss">Main Sponsor: stake</label>
                </div>   
                <div class="field r24">
                    <input type="text" name="msl" id="msl" required placeholder="ITC Fortune Park">
                    <label for="msl">Main Sponsor: location of stay</label>
                </div>   
                <button class="sub" type="submit" form="create" id="load">
                    Submit<i class="icon ion-ios-checkmark" style="border: none;"></i>
                </button>
                <button class="sub">
                    Cancel
                    <i class="icon ion-ios-close" style="border: none;"></i>
                </button>
            </form>
        </div>
<!--
{"event":{
 "clubName":"GDG",
 "name":"DEVRELCONF",
 "toDate":"10TH OCTOBER",
 "fromDate":"8TH OCTOBER",
 "toTime":"10 PM",
 "fromTime":"11 AM",
 "budget":"200000",
 "description":"TECHNICAL EVENT AT GDG VIT. ITS GONNA BE AMAZING",
 "category":"TECHNICAL",
 "venue":"ANNA AUDI",
 "attendance":"4000",
 "expectedParticipants":"4000",
 "facultyCoordinator":{
    "name":"NOORU MAA",
    "registrationNumber":"17BBE1010",
    "email":"SDADAS@A.COM",
    "phoneNumber":"919191991911",
    "gender":"M",
    "eventsAttended":"ALL"
 },
 "studentCoordinator":{
    "name":"NOOR",
    "registrationNumber":"17BBE1010",
    "email":"SDADAS@A.COM",
    "phoneNumber":"919191991911",
    "gender":"M",
    "eventsAttended":"ALL"
 },
 "guest":{
    "name":"DAAS",
    "email":"ASDSAD#ASD.COM",
    "phoneNumber":"11111111111",
    "gender":"F",
    "stake":"SOME MONAYYYY",
    "locationOfStay":"GHAR"
 },
 "PROrequest":"SAJDOOSIJANDFSAKFDSAFD",
 "campusEngineerRequest":"SDFHBSADUB, ASNFD , AS KDFSAM FDSA, AS, SD",
 "duration":"16 hours",
 "mainSponsor":{
    "name":"DAASA",
    "email":"ASDSAD#ASD.COM",
    "phoneNumber":"11111111111",
    "gender":"F",
    "stake":"SOME MONAYYYY",
    "locationOfStay":"GHAR2"
 }
}
-->
        <script type="text/javascript">
            var queryString = decodeURIComponent(window.location.search);
            queryString = queryString.substring(1);
            total=queryString.split("&");
            club=total[0].split("=")
            var queries = total[1].split("=");
            document.getElementById("back").innerHTML = '<a href="partman.html?clubName='+club[1]+'&eventName='+queries[1]+'"><i class="arrowbig left"></i></a>'
            $(document).ready(function (){
                $("#load").click(function(e) {
                    e.preventDefault();
                    chkConstraints();
                })
                function chkConstraints() {
                    var constraints = {
                    "name" : [ /^[A-z ]+$/, "Must be text!" ],
                    "email" : [ /^[A-z0-9.]+@[A-z0-9.]+.[A-z0-9]+$/ , "Enter Valid Email" ],
                    "phone" : [ /^[0-9]{10}$/, "Enter 10 digit mobile number" ]
                    };
                    var name = document.getElementById("name").value;
                    var regno = document.getElementById("regno").value;
                    var email = document.getElementById("email").value;
                    var phone = document.getElementById("phone").value;
                    var gender = document.getElementById("gender").value;
                    var constraint1 = new RegExp(constraints["name"][0],"");
                    var constraint2 = new RegExp(constraints["email"][0],"");
                    var constraint3 = new RegExp(constraints["phone"][0],"");
                    if (!constraint1.test(name)) {
                        console.log("wrong name");
                        var element = $("#name")[0];
                        element.setCustomValidity(constraints["name"][1]);
                    }
                    else if (regno === ""){
                        alert("Enter valid Registration Number");
                    }
                    else if (!constraint2.test(email)) {
                        alert(constraints["email"][1]);
                    }
                    else if (!constraint3.test(phone)) {
                        alert(constraints["phone"][1]);
                    }
                    else if (gender !== "M" || gender !=="F"){
                        alert("Enter Either M or F");
                    }
                    else {                    
                        input = JSON.stringify({
                            "details":{
                            "name" : $('#name').val(),
                            "registrationNumber" : $('#regno').val(),
                            "email" : $('#email').val(),
                            "phone" : $('#phone').val(),
                            "gender" : $('#gender').val(),
                            "eventAttended" : "ALL",
                            "eventName" : queries[1]
                            }
                        })
                        var frm = document.getElementById("create").reset();
                        console.log(input);
                        $.ajax({
                            type: "POST",
                            url: "http://206.189.133.125/api/v1/participants/create-attendee",
                            data:input
                        }).done(function (data) {
                            if(data.rs==="created"){
                                swal("Yaay!", "You have created a new participant!", "success");
                            }                           
                        });
                    }
                }
            })
            
            
        </script>
    </body>
</html>